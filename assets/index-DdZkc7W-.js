import{u as oe,t as Q,a as ae,i as re,b as I,w as ie,c as le,d as se,e as X,n as ue,f as ce,g as fe}from"./index-C32mnd9j.js";import{r as y,a0 as K,l as ne,w as Z,b8 as g,$ as de,n as pe,o as ye,x as ve}from"./index-BA5aWebT.js";const H=re?window:void 0;function he(e){var t;const n=I(e);return(t=n?.$el)!=null?t:n}function B(...e){let t,n,l,s;if(typeof e[0]=="string"||Array.isArray(e[0])?([n,l,s]=e,t=H):[t,n,l,s]=e,!t)return ue;Array.isArray(n)||(n=[n]),Array.isArray(l)||(l=[l]);const r=[],a=()=>{r.forEach(p=>p()),r.length=0},O=(p,u,m,i)=>(p.addEventListener(u,m,i),()=>p.removeEventListener(u,m,i)),T=Z(()=>[he(t),I(s)],([p,u])=>{if(a(),!p)return;const m=ce(u)?{...u}:u;r.push(...n.flatMap(i=>l.map(h=>O(p,i,h,m))))},{immediate:!0,flush:"post"}),w=()=>{T(),a()};return fe(w),w}function we(){const e=y(!1),t=ve();return t&&ye(()=>{e.value=!0},t),e}function me(e){const t=we();return ne(()=>(t.value,!!e()))}const U=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},$="__vueuse_ssr_handlers__",ge=be();function be(){return $ in U||(U[$]=U[$]||{}),U[$]}function Se(e,t){return ge[e]||t}function Oe(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const Ee={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},ee="vueuse-storage";function Te(e,t,n,l={}){var s;const{flush:r="pre",deep:a=!0,listenToStorageChanges:O=!0,writeDefaults:T=!0,mergeDefaults:w=!1,shallow:p,window:u=H,eventFilter:m,onError:i=o=>{console.error(o)},initOnMounted:h}=l,b=(p?K:y)(typeof t=="function"?t():t);if(!n)try{n=Se("getDefaultStorage",()=>{var o;return(o=H)==null?void 0:o.localStorage})()}catch(o){i(o)}if(!n)return b;const S=I(t),P=Oe(S),F=(s=l.serializer)!=null?s:Ee[P],{pause:k,resume:G}=ie(b,()=>N(b.value),{flush:r,deep:a,eventFilter:m});u&&O&&le(()=>{n instanceof Storage?B(u,"storage",A):B(u,ee,z),h&&A()}),h||A();function D(o,c){if(u){const f={key:e,oldValue:o,newValue:c,storageArea:n};u.dispatchEvent(n instanceof Storage?new StorageEvent("storage",f):new CustomEvent(ee,{detail:f}))}}function N(o){try{const c=n.getItem(e);if(o==null)D(c,null),n.removeItem(e);else{const f=F.write(o);c!==f&&(n.setItem(e,f),D(c,f))}}catch(c){i(c)}}function J(o){const c=o?o.newValue:n.getItem(e);if(c==null)return T&&S!=null&&n.setItem(e,F.write(S)),S;if(!o&&w){const f=F.read(c);return typeof w=="function"?w(f,S):P==="object"&&!Array.isArray(f)?{...S,...f}:f}else return typeof c!="string"?c:F.read(c)}function A(o){if(!(o&&o.storageArea!==n)){if(o&&o.key==null){b.value=S;return}if(!(o&&o.key!==e)){k();try{o?.newValue!==F.write(b.value)&&(b.value=J(o))}catch(c){i(c)}finally{o?pe(G):G()}}}}function z(o){A(o.detail)}return b}const Fe={json:"application/json",text:"text/plain"};function te(e){return e&&se(e,"immediate","refetch","initialData","timeout","beforeFetch","afterFetch","onFetchError","fetch","updateDataOnError")}function Y(e){return typeof Headers<"u"&&e instanceof Headers?Object.fromEntries(e.entries()):e}function je(e,...t){var n;const l=typeof AbortController=="function";let s={},r={immediate:!0,refetch:!1,timeout:0,updateDataOnError:!1};const a={method:"GET",type:"text",payload:void 0};t.length>0&&(te(t[0])?r={...r,...t[0]}:s=t[0]),t.length>1&&te(t[1])&&(r={...r,...t[1]});const{fetch:O=(n=H)==null?void 0:n.fetch,initialData:T,timeout:w}=r,p=X(),u=X(),m=X(),i=y(!1),h=y(!1),b=y(!1),S=y(null),P=K(null),F=K(null),k=K(T||null),G=ne(()=>l&&h.value);let D,N;const J=()=>{l&&(D?.abort(),D=new AbortController,D.signal.onabort=()=>b.value=!0,s={...s,signal:D.signal})},A=v=>{h.value=v,i.value=!v};w&&(N=oe(J,w,{immediate:!1}));let z=0;const o=async(v=!1)=>{var E,x;J(),A(!0),F.value=null,S.value=null,b.value=!1,z+=1;const V=z,M={method:a.method,headers:{}};if(a.payload){const d=Y(M.headers),j=I(a.payload);!a.payloadType&&j&&Object.getPrototypeOf(j)===Object.prototype&&!(j instanceof FormData)&&(a.payloadType="json"),a.payloadType&&(d["Content-Type"]=(E=Fe[a.payloadType])!=null?E:a.payloadType),M.body=a.payloadType==="json"?JSON.stringify(j):j}let R=!1;const W={url:I(e),options:{...M,...s},cancel:()=>{R=!0}};if(r.beforeFetch&&Object.assign(W,await r.beforeFetch(W)),R||!O)return A(!1),Promise.resolve(null);let _=null;return N&&N.start(),O(W.url,{...M,...W.options,headers:{...Y(M.headers),...Y((x=W.options)==null?void 0:x.headers)}}).then(async d=>{if(P.value=d,S.value=d.status,_=await d.clone()[a.type](),!d.ok)throw k.value=T||null,new Error(d.statusText);return r.afterFetch&&({data:_}=await r.afterFetch({data:_,response:d})),k.value=_,p.trigger(d),d}).catch(async d=>{let j=d.message||d.name;if(r.onFetchError&&({error:j,data:_}=await r.onFetchError({data:_,error:d,response:P.value})),F.value=j,r.updateDataOnError&&(k.value=_),u.trigger(d),v)throw d;return null}).finally(()=>{V===z&&A(!1),N&&N.stop(),m.trigger(null)})},c=Q(r.refetch);Z([c,Q(e)],([v])=>v&&o(),{deep:!0});const f={isFinished:g(i),isFetching:g(h),statusCode:S,response:P,error:F,data:k,canAbort:G,aborted:b,abort:J,execute:o,onFetchResponse:p.on,onFetchError:u.on,onFetchFinally:m.on,get:C("GET"),put:C("PUT"),post:C("POST"),delete:C("DELETE"),patch:C("PATCH"),head:C("HEAD"),options:C("OPTIONS"),json:L("json"),text:L("text"),blob:L("blob"),arrayBuffer:L("arrayBuffer"),formData:L("formData")};function C(v){return(E,x)=>{if(!h.value)return a.method=v,a.payload=E,a.payloadType=x,de(a.payload)&&Z([c,Q(a.payload)],([V])=>V&&o(),{deep:!0}),{...f,then(V,M){return q().then(V,M)}}}}function q(){return new Promise((v,E)=>{ae(i).toBe(!0).then(()=>v(f)).catch(x=>E(x))})}function L(v){return()=>{if(!h.value)return a.type=v,{...f,then(E,x){return q().then(E,x)}}}}return r.immediate&&Promise.resolve().then(()=>o()),{...f,then(v,E){return q().then(v,E)}}}function Ne(e,t,n={}){const{window:l=H}=n;return Te(e,t,l?.localStorage,n)}function De(e={}){const{window:t=H}=e,n=t?.navigator,l=me(()=>n&&"connection"in n),s=y(!0),r=y(!1),a=y(void 0),O=y(void 0),T=y(void 0),w=y(void 0),p=y(void 0),u=y(void 0),m=y("unknown"),i=l.value&&n.connection;function h(){n&&(s.value=n.onLine,a.value=s.value?void 0:Date.now(),O.value=s.value?Date.now():void 0,i&&(T.value=i.downlink,w.value=i.downlinkMax,u.value=i.effectiveType,p.value=i.rtt,r.value=i.saveData,m.value=i.type))}return t&&(B(t,"offline",()=>{s.value=!1,a.value=Date.now()}),B(t,"online",()=>{s.value=!0,O.value=Date.now()})),i&&B(i,"change",h,!1),h(),{isSupported:g(l),isOnline:g(s),saveData:g(r),offlineAt:g(a),onlineAt:g(O),downlink:g(T),downlinkMax:g(w),effectiveType:g(u),rtt:g(p),type:g(m)}}function Ce(e={}){const{isOnline:t}=De(e);return t}export{Ne as a,Ce as b,je as u};
