import{Q as te}from"./QSpace-DhHYc43V.js";import{Q as ue}from"./QColor-CdTula2t.js";import{Q as me}from"./QPopupProxy-C0VbnuWx.js";import{c as U,h as C,t as N,a as re,a5 as fe,r as S,l as w,O as j,q as F,bb as K,x as X,j as pe,k as W,bc as ae,bd as ve,e as be,g as ge,ae as _e,A as Ce,s as Se,d as O,H as le,I as H,o as Z,_ as I,B as h,S as $,aJ as he,F as E,G as L,C as D,af as ye,D as p,E as i,ag as z,N as A,X as V,aX as Y,w as we,a6 as G,Q as k,be as J,a8 as ne,aV as De,J as xe,aY as Be,b3 as ke,aA as Ve,V as qe,aC as Pe}from"./index-BA5aWebT.js";import{Q as Ee}from"./QPage-PcLTelbh.js";import{u as Oe,a as Ie,b as Te,c as Qe}from"./use-panel-COGt6Vzr.js";import{u as Ue}from"./use-render-cache-DLxPkVnQ.js";import{Q as Ae}from"./QForm-np2oPtr3.js";import{u as ie}from"./card-D-jiq-ML.js";import{P as Me,B as se}from"./passwordInput-DMtjrS1W.js";import{h as Re}from"./index-C32mnd9j.js";import{Q as je}from"./QSelect-n0rZZ86P.js";import{a as M,b as R,Q as ee}from"./QItemLabel-C26Gfd9w.js";import{P as Ne,Q as Fe,R as Le,B as ze,S as He,s as We,T as Ke}from"./index-BqawO4WD.js";import{d as Ye}from"./vuedraggable.umd-DhNZDiYf.js";import{u as Ge,D as Je}from"./deleteDialog-CqpYPVC_.js";import"./TouchPan-Q14waBmd.js";import"./selection-DbtMzwTB.js";import"./format-hlGAdIUH.js";import"./QResizeObserver-C0OKpkct.js";import"./QMenu-BRIDIeWr.js";import"./index-BALEXJ3-.js";import"./_commonjsHelpers-BosuxZz1.js";import"./vue.runtime.esm-bundler-BnDNC94M.js";import"./QChip-BPe3AwEH.js";const T=U({name:"QStepperNavigation",setup(t,{slots:o}){return()=>C("div",{class:"q-stepper__nav"},N(o.default))}}),Xe=U({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(t,{slots:o,emit:u}){let e=!1,n,m,r=null,d=null,s,b;function g(){n&&n(),n=null,e=!1,r!==null&&(clearTimeout(r),r=null),d!==null&&(clearTimeout(d),d=null),m!==void 0&&m.removeEventListener("transitionend",s),s=null}function f(c,l,a){l!==void 0&&(c.style.height=`${l}px`),c.style.transition=`height ${t.duration}ms cubic-bezier(.25, .8, .50, 1)`,e=!0,n=a}function _(c,l){c.style.overflowY=null,c.style.height=null,c.style.transition=null,g(),l!==b&&u(l)}function x(c,l){let a=0;m=c,e===!0?(g(),a=c.offsetHeight===c.scrollHeight?0:void 0):(b="hide",c.style.overflowY="hidden"),f(c,a,l),r=setTimeout(()=>{r=null,c.style.height=`${c.scrollHeight}px`,s=v=>{d=null,(Object(v)!==v||v.target===c)&&_(c,"show")},c.addEventListener("transitionend",s),d=setTimeout(s,t.duration*1.1)},100)}function B(c,l){let a;m=c,e===!0?g():(b="show",c.style.overflowY="hidden",a=c.scrollHeight),f(c,a,l),r=setTimeout(()=>{r=null,c.style.height=0,s=v=>{d=null,(Object(v)!==v||v.target===c)&&_(c,"hide")},c.addEventListener("transitionend",s),d=setTimeout(s,t.duration*1.1)},100)}return re(()=>{e===!0&&g()}),()=>C(fe,{css:!1,appear:t.appear,onEnter:x,onLeave:B},o.default)}}),de=U({name:"StepHeader",props:{stepper:{},step:{},goToPanel:Function},setup(t,{attrs:o}){const{proxy:{$q:u}}=X(),e=S(null),n=w(()=>t.stepper.modelValue===t.step.name),m=w(()=>{const l=t.step.disable;return l===!0||l===""}),r=w(()=>{const l=t.step.error;return l===!0||l===""}),d=w(()=>{const l=t.step.done;return m.value===!1&&(l===!0||l==="")}),s=w(()=>{const l=t.step.headerNav,a=l===!0||l===""||l===void 0;return m.value===!1&&t.stepper.headerNav&&a}),b=w(()=>t.step.prefix&&(n.value===!1||t.stepper.activeIcon==="none")&&(r.value===!1||t.stepper.errorIcon==="none")&&(d.value===!1||t.stepper.doneIcon==="none")),g=w(()=>{const l=t.step.icon||t.stepper.inactiveIcon;if(n.value===!0){const a=t.step.activeIcon||t.stepper.activeIcon;return a==="none"?l:a||u.iconSet.stepper.active}if(r.value===!0){const a=t.step.errorIcon||t.stepper.errorIcon;return a==="none"?l:a||u.iconSet.stepper.error}if(m.value===!1&&d.value===!0){const a=t.step.doneIcon||t.stepper.doneIcon;return a==="none"?l:a||u.iconSet.stepper.done}return l}),f=w(()=>{const l=r.value===!0?t.step.errorColor||t.stepper.errorColor:void 0;if(n.value===!0){const a=t.step.activeColor||t.stepper.activeColor||t.step.color;return a!==void 0?a:l}return l!==void 0?l:m.value===!1&&d.value===!0?t.step.doneColor||t.stepper.doneColor||t.step.color||t.stepper.inactiveColor:t.step.color||t.stepper.inactiveColor}),_=w(()=>"q-stepper__tab col-grow flex items-center no-wrap relative-position"+(f.value!==void 0?` text-${f.value}`:"")+(r.value===!0?" q-stepper__tab--error q-stepper__tab--error-with-"+(b.value===!0?"prefix":"icon"):"")+(n.value===!0?" q-stepper__tab--active":"")+(d.value===!0?" q-stepper__tab--done":"")+(s.value===!0?" q-stepper__tab--navigation q-focusable q-hoverable":"")+(m.value===!0?" q-stepper__tab--disabled":"")),x=w(()=>t.stepper.headerNav!==!0?!1:s.value);function B(){e.value!==null&&e.value.focus(),n.value===!1&&t.goToPanel(t.step.name)}function c(l){l.keyCode===13&&n.value===!1&&t.goToPanel(t.step.name)}return()=>{const l={class:_.value};s.value===!0&&(l.onClick=B,l.onKeyup=c,Object.assign(l,m.value===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:o.tabindex||0}));const a=[C("div",{class:"q-focus-helper",tabindex:-1,ref:e}),C("div",{class:"q-stepper__dot row flex-center q-stepper__line relative-position"},[C("span",{class:"row flex-center"},[b.value===!0?t.step.prefix:C(j,{name:g.value})])])];if(t.step.title!==void 0&&t.step.title!==null){const v=[C("div",{class:"q-stepper__title"},t.step.title)];t.step.caption!==void 0&&t.step.caption!==null&&v.push(C("div",{class:"q-stepper__caption"},t.step.caption)),a.push(C("div",{class:"q-stepper__label q-stepper__line relative-position"},v))}return F(C("div",l,a),[[K,x.value]])}}});function ce(t){return C("div",{class:"q-stepper__step-content"},[C("div",{class:"q-stepper__step-inner"},N(t.default))])}const oe={setup(t,{slots:o}){return()=>ce(o)}},Q=U({name:"QStep",props:{...Oe,icon:String,color:String,title:{type:String,required:!0},caption:String,prefix:[String,Number],doneIcon:String,doneColor:String,activeIcon:String,activeColor:String,errorIcon:String,errorColor:String,headerNav:{type:Boolean,default:!0},done:Boolean,error:Boolean,onScroll:[Function,Array]},setup(t,{slots:o,emit:u}){const{proxy:{$q:e}}=X(),n=pe(ae,W);if(n===W)return console.error("QStep needs to be a child of QStepper"),W;const{getCache:m}=Ue(),r=S(null),d=w(()=>n.value.modelValue===t.name),s=w(()=>e.platform.is.ios!==!0&&e.platform.is.chrome===!0||d.value!==!0||n.value.vertical!==!0?{}:{onScroll(f){const{target:_}=f;_.scrollTop>0&&(_.scrollTop=0),t.onScroll!==void 0&&u("scroll",f)}}),b=w(()=>typeof t.name=="string"||typeof t.name=="number"?t.name:String(t.name));function g(){const f=n.value.vertical;return f===!0&&n.value.keepAlive===!0?C(ve,n.value.keepAliveProps.value,d.value===!0?[C(n.value.needsUniqueKeepAliveWrapper.value===!0?m(b.value,()=>({...oe,name:b.value})):oe,{key:b.value},o.default)]:void 0):f!==!0||d.value===!0?ce(o):void 0}return()=>C("div",{ref:r,class:"q-stepper__step",role:"tabpanel",...s.value},n.value.vertical===!0?[C(de,{stepper:n.value,step:t,goToPanel:n.value.goToPanel}),n.value.animated===!0?C(Xe,g):g()]:[g()])}}),Ze=/(-\w)/g;function $e(t){const o={};for(const u in t){const e=u.replace(Ze,n=>n[1].toUpperCase());o[e]=t[u]}return o}const eo=U({name:"QStepper",props:{...be,...Ie,flat:Boolean,bordered:Boolean,alternativeLabels:Boolean,headerNav:Boolean,contracted:Boolean,headerClass:String,inactiveColor:String,inactiveIcon:String,doneIcon:String,doneColor:String,activeIcon:String,activeColor:String,errorIcon:String,errorColor:String},emits:Te,setup(t,{slots:o}){const u=X(),e=ge(t,u.proxy.$q),{updatePanelsList:n,isValidPanelName:m,updatePanelIndex:r,getPanelContent:d,getPanels:s,panelDirectives:b,goToPanel:g,keepAliveProps:f,needsUniqueKeepAliveWrapper:_}=Qe();_e(ae,w(()=>({goToPanel:g,keepAliveProps:f,needsUniqueKeepAliveWrapper:_,...t})));const x=w(()=>`q-stepper q-stepper--${t.vertical===!0?"vertical":"horizontal"}`+(t.flat===!0?" q-stepper--flat":"")+(t.bordered===!0?" q-stepper--bordered":"")+(e.value===!0?" q-stepper--dark q-dark":"")),B=w(()=>`q-stepper__header row items-stretch justify-between q-stepper__header--${t.alternativeLabels===!0?"alternative":"standard"}-labels`+(t.flat===!1||t.bordered===!0?" q-stepper__header--border":"")+(t.contracted===!0?" q-stepper__header--contracted":"")+(t.headerClass!==void 0?` ${t.headerClass}`:""));function c(){const l=N(o.message,[]);if(t.vertical===!0){m(t.modelValue)&&r();const a=C("div",{class:"q-stepper__content"},N(o.default));return l===void 0?[a]:l.concat(a)}return[C("div",{class:B.value},s().map(a=>{const v=$e(a.props);return C(de,{key:v.name,stepper:t,step:v,goToPanel:g})})),l,Se("div",{class:"q-stepper__content q-panel-parent"},d(),"cont",t.swipeable,()=>b.value)]}return()=>(n(o),C("div",{class:x.value},Ce(o.navigation,c())))}}),oo=O({__name:"BarcodeDetection",props:{form:{type:Object,required:!0},formModifiers:{}},emits:le(["detection-error"],["update:form"]),setup(t,{expose:o,emit:u}){o();const e=H(t,"form"),n=u,m=window.BarcodeDetector||class{},r=S(null),d=S(),s=S(null),b=S(null);async function g(){try{const a=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"},audio:!1});s.value&&(s.value.srcObject=a,s.value.onloadedmetadata=()=>{s.value?.play(),setTimeout(()=>{f()},12e3)},console.dir(s.value))}catch(a){console.log(a)}}function f(){s.value?.srcObject?.getTracks().forEach(a=>{a.stop()}),_.pause()}const _=Re(()=>{x()},3e3);function x(){if(s.value){const a=document.createElement("canvas");a.width=s.value.videoWidth,a.height=s.value.videoHeight;const v=a.getContext("2d");if(v){v.drawImage(s.value,0,0,a.width,a.height);const y=a.toDataURL("image/png");b.value=y;const q=document.createElement("img");q.src=y,q.onload=()=>{B(q)},q.onerror=()=>{console.error("Impossible de charger l'image"),d.value="Erreur de chargement de l'image"}}}}const B=async a=>{if(!("BarcodeDetector"in window)||!window.BarcodeDetector){f(),n("detection-error",{message:"BarcodeDetector ne fonctionne pas sur ce navigateur, merci de saisir manuellement le code barre"});return}try{d.value="Détection en cours..., garder l'image stable pendant 3s";const y=await new m({formats:["qr_code","code_128","ean_13","code_39","code_93","codabar","ean_8","itf","upc_a","upc_e"]}).detect(a);y.length>0?(r.value={code:y[0].rawValue,format:c(y[0].format)},d.value="Code-barre détecté !",e.value.barcode=r.value,f()):d.value="Aucun code-barres détecté... continuer la détection"}catch(v){console.error("Erreur lors de la détection :",v),f(),d.value="Erreur lors de la détection"}};function c(a){let v=[];return a.includes("code")?(v=a.split("_"),v.join("").toUpperCase()):a.includes("ean")?(v=a.split("_"),v.join("-").toUpperCase()):a.length?"CODE128":a.toUpperCase()}Z(()=>{g()}),re(()=>{f()});const l={form:e,emit:n,BarcodeDetector:m,barcodeDetected:r,codeBarMessage:d,videoElement:s,imagePreview:b,startCamera:g,stopCamera:f,getBarcodeFromVideoInterval:_,extractPictureFromVideo:x,detectBarcode:B,formatBarcodeFormat:c};return Object.defineProperty(l,"__isScriptSetup",{enumerable:!1,value:!0}),l}}),to={class:"flex flex-center my-2"},ro={ref:"videoElement",class:"rounded-md"},ao={class:"mt-2 font-bold italic"};function lo(t,o,u,e,n,m){return h(),$("div",to,[F(E("video",ro,null,512),[[he,!e.barcodeDetected]]),E("p",ao,L(e.codeBarMessage),1)])}const no=I(oo,[["render",lo],["__file","BarcodeDetection.vue"]]),P=[{id:0,label:"Leclerc"},{id:1,label:"Carrefour"},{id:2,label:"Intermarché"},{id:3,label:"Auchan"},{id:4,label:"Super U"},{id:5,label:"Casino"},{id:6,label:"Lidl"},{id:7,label:"Aldi"},{id:8,label:"Monoprix"},{id:9,label:"Franprix"},{id:10,label:"Cora"},{id:11,label:"Boulanger"},{id:12,label:"Darty"},{id:13,label:"FNAC"},{id:14,label:"Sephora"},{id:15,label:"Marionnaud"},{id:16,label:"Nocibé"},{id:17,label:"Decathlon"},{id:18,label:"Go Sport"},{id:19,label:"Zara"},{id:20,label:"H&M"},{id:21,label:"C&A"},{id:22,label:"Kiabi"},{id:23,label:"Gémo"},{id:24,label:"Jules"},{id:25,label:"Celio"},{id:26,label:"Bershka"},{id:27,label:"Stradivarius"},{id:28,label:"Etam"},{id:29,label:"Yves Rocher"}],io=O({__name:"ShopOptions",props:{form:{type:Object,required:!0},formModifiers:{}},emits:["update:form"],setup(t,{expose:o}){o();const u=H(t,"form"),e=S(P);function n(s,b){b(()=>{if(s==="")e.value=P;else{const g=s.toLowerCase();e.value=P.filter(f=>f.label.toLowerCase().indexOf(g)>-1)}})}function m(s,b){if(s.length>0){const g=P.find(_=>_.label.toLowerCase()===s.toLowerCase()),f={label:s,id:P.length+1};g||P.push(f),b(f,"toggle")}}function r(){u.value.shop={label:"",id:0}}const d={form:u,filterOptions:e,handleFilter:n,createShops:m,resetModel:r};return Object.defineProperty(d,"__isScriptSetup",{enumerable:!1,value:!0}),d}});function so(t,o,u,e,n,m){return h(),D(je,{modelValue:e.form.shop,"onUpdate:modelValue":o[0]||(o[0]=r=>e.form.shop=r),options:e.filterOptions,label:"Séléctionne une enseigne","use-input":"","input-debounce":"0",behavior:"menu","lazy-rules":"",rules:[r=>r&&r.label.length>0||"Une enseigne doit etre sélectionnée"],onNewValue:e.createShops,onFocus:e.resetModel,onFilter:e.handleFilter},null,8,["modelValue","options","rules"])}const co=I(io,[["render",so],["__file","ShopOptions.vue"]]),uo=O({__name:"BarcodeInput",props:{form:{type:Object,required:!0},formModifiers:{}},emits:le(["barcode-preview"],["update:form"]),setup(t,{expose:o}){o();const u=H(t,"form"),e=S(null);Z(()=>{e.value.focus()});const n={form:u,barcodeInput:e};return Object.defineProperty(n,"__isScriptSetup",{enumerable:!1,value:!0}),n}});function mo(t,o,u,e,n,m){return h(),D(ye,{ref:"barcodeInput",modelValue:e.form.barcode.code,"onUpdate:modelValue":o[0]||(o[0]=r=>e.form.barcode.code=r),filled:"",label:"Numéro client",class:"form-list-name",type:"number","lazy-rules":!1,rules:[r=>r&&r.length>0||"Taper au moins un nombre ou une lettre"],onBlur:o[1]||(o[1]=r=>t.$emit("barcode-preview"))},null,8,["modelValue","rules"])}const fo=I(uo,[["render",mo],["__file","BarcodeInput.vue"]]),po=O({__name:"CardOptions",props:{form:{type:Object,required:!0},formModifiers:{}},emits:["update:form"],setup(t,{expose:o}){o();const e={form:H(t,"form"),PasswordInput:Me};return Object.defineProperty(e,"__isScriptSetup",{enumerable:!1,value:!0}),e}});function vo(t,o,u,e,n,m){return h(),$("div",null,[F((h(),D(ee,{tag:"label"},{default:p(()=>[i(M,{avatar:""},{default:p(()=>[i(z,{modelValue:e.form.isShoppingCard,"onUpdate:modelValue":o[0]||(o[0]=r=>e.form.isShoppingCard=r)},null,8,["modelValue"])]),_:1}),i(M,null,{default:p(()=>[i(R,null,{default:p(()=>o[3]||(o[3]=[A("Carte pour les achats en magasin ?")])),_:1}),i(R,{caption:""},{default:p(()=>o[4]||(o[4]=[A("Pour l'utiliser en lien avec shopping liste !")])),_:1})]),_:1})]),_:1})),[[K]]),F((h(),D(ee,{tag:"label"},{default:p(()=>[i(M,{avatar:""},{default:p(()=>[i(z,{modelValue:e.form.isCardCode,"onUpdate:modelValue":o[1]||(o[1]=r=>e.form.isCardCode=r)},null,8,["modelValue"])]),_:1}),i(M,null,{default:p(()=>[i(R,null,{default:p(()=>o[5]||(o[5]=[A("Associer un code à la carte ?")])),_:1}),i(R,{caption:""},{default:p(()=>o[6]||(o[6]=[A("Si vous avez besoin d'un code pour utiliser la carte")])),_:1})]),_:1})]),_:1})),[[K]]),e.form.isCardCode?(h(),D(e.PasswordInput,{key:0,password:e.form.password,"onUpdate:password":o[2]||(o[2]=r=>e.form.password=r)},null,8,["password"])):V("",!0)])}const bo=I(po,[["render",vo],["__file","CardOptions.vue"]]),go=O({__name:"CardDialog",setup(t,{expose:o}){o();const u=ie(),{isDialogCardVisible:e}=Y(u),n=S(""),m=S(!1),r=S(!1),d=S(!1),s=S(""),b=S(!1),g=S(1),f=S({id:0,shop:{id:null,label:""},barcode:{code:"123",format:"CODE128"},isShoppingCard:!1,isCardCode:!1,password:"",color:"rgb(232,149,149)"});function _(y){y===4&&(g.value===3||g.value===2)&&x(),g.value=y}function x(){m.value=!0}async function B(){try{b.value=!0,f.value.id=Date.now(),await u.addcard(f.value),c(),b.value=!1}catch(y){const q=y;n.value=q.message,b.value=!1}}function c(){u.hideDialogCard(),l()}function l(){r.value=!1,d.value=!1,s.value="",g.value=1,f.value={id:0,shop:{id:null,label:""},barcode:{code:"",format:"CODE128"},isShoppingCard:!1,isCardCode:!1,password:"",color:null}}function a(y){d.value=!1,s.value=y.message}we(g,y=>{y===2&&(r.value=!1,d.value=!1)});const v={cardStore:u,isDialogCardVisible:e,responseError:n,showBarcodePreview:m,isBarcodeManual:r,isCameraAllowed:d,barcodeDetectionErrorMessage:s,isSaving:b,step:g,form:f,goToStep:_,barcodePreview:x,onSubmit:B,closeDialog:c,onReset:l,handleBarcodeDetectionError:a,BarCodeRender:se,BarcodeDetection:no,ShopOptions:co,BarcodeInput:fo,CardOptions:bo,get mdiBarcode(){return Ne},get mdiBarcodeOff(){return Fe},get mdiBarcodeScan(){return Le},get mdiListBoxOutline(){return ze},get mdiStoreSearch(){return He}};return Object.defineProperty(v,"__isScriptSetup",{enumerable:!1,value:!0}),v}}),_o={class:"mb-2 italic"},Co={key:0,class:"text-sm italic text-red-400"};function So(t,o,u,e,n,m){return h(),D(De,{modelValue:e.isDialogCardVisible,"onUpdate:modelValue":o[16]||(o[16]=r=>e.isDialogCardVisible=r),onHide:e.onReset},{default:p(()=>[i(ne,{style:{width:"400px","max-width":"90vw"}},{default:p(()=>[i(G,{class:"row items-center"},{default:p(()=>[o[17]||(o[17]=E("div",{class:"text-h6"},"Ajouter une carte",-1)),i(te),i(k,{icon:"close",class:"btn-close",flat:"",round:"",dense:"",onClick:e.closeDialog})]),_:1}),i(Ae,{onSubmit:J(e.onSubmit,["prevent"]),onReset:e.onReset},{default:p(()=>[i(eo,{modelValue:e.step,"onUpdate:modelValue":o[15]||(o[15]=r=>e.step=r),vertical:"",color:"primary",animated:""},{default:p(()=>[i(Q,{name:1,title:"Choix de l'enseigne",icon:e.mdiStoreSearch,done:e.step>1},{default:p(()=>[i(e.ShopOptions,{form:e.form,"onUpdate:form":o[0]||(o[0]=r=>e.form=r)},null,8,["form"]),i(T,null,{default:p(()=>[i(k,{color:"primary",disable:!e.form.shop.label.length,label:"Continue",onClick:o[1]||(o[1]=r=>e.goToStep(2))},null,8,["disable"])]),_:1})]),_:1},8,["icon","done"]),i(Q,{name:2,title:"Capture du code barre",icon:e.mdiBarcodeScan,done:e.step>2},{default:p(()=>[e.barcodeDetectionErrorMessage?V("",!0):(h(),D(z,{key:0,modelValue:e.isCameraAllowed,"onUpdate:modelValue":o[2]||(o[2]=r=>e.isCameraAllowed=r),class:"mb-4",label:"Utiliser la caméra pour scanner le code barre"},null,8,["modelValue"])),E("p",_o,L(e.barcodeDetectionErrorMessage),1),e.isCameraAllowed?V("",!0):(h(),D(z,{key:1,modelValue:e.isBarcodeManual,"onUpdate:modelValue":o[3]||(o[3]=r=>e.isBarcodeManual=r),label:`${e.barcodeDetectionErrorMessage?"Saisir":"Ou saisir"} manuellement le code`,onClick:o[4]||(o[4]=r=>e.step=3)},null,8,["modelValue","label"])),e.isCameraAllowed?(h(),D(e.BarcodeDetection,{key:2,form:e.form,"onUpdate:form":o[5]||(o[5]=r=>e.form=r),onDetectionError:e.handleBarcodeDetectionError},null,8,["form"])):V("",!0),i(T,null,{default:p(()=>[e.form.barcode.code.length?(h(),D(k,{key:0,color:"primary",label:"Continue",onClick:o[6]||(o[6]=r=>e.goToStep(4))})):V("",!0),i(k,{flat:"",color:"primary",label:"Back",class:"q-ml-sm",onClick:o[7]||(o[7]=r=>e.goToStep(1))})]),_:1})]),_:1},8,["icon","done"]),i(Q,{name:3,title:"Saisie manuelle du code barre",caption:"Optionnel",disable:!e.isBarcodeManual,icon:e.mdiBarcodeOff,done:e.step>2},{default:p(()=>[i(e.BarcodeInput,{form:e.form,"onUpdate:form":o[8]||(o[8]=r=>e.form=r),onBarcodePreview:e.barcodePreview},null,8,["form"]),i(T,null,{default:p(()=>[i(k,{color:"primary",label:"Continue",disable:!e.form.barcode.code.length,onClick:o[9]||(o[9]=r=>e.goToStep(4))},null,8,["disable"]),i(k,{flat:"",color:"primary",label:"Back",class:"q-ml-sm",onClick:o[10]||(o[10]=r=>e.goToStep(2))})]),_:1})]),_:1},8,["disable","icon","done"]),i(Q,{name:4,title:"Ajout Options",icon:e.mdiListBoxOutline,done:e.step>3},{default:p(()=>[i(e.CardOptions,{form:e.form,"onUpdate:form":o[11]||(o[11]=r=>e.form=r)},null,8,["form"]),i(T,null,{default:p(()=>[i(k,{color:"primary",disable:e.form.isCardCode&&!e.form.password.length,label:"Aperçu",onClick:o[12]||(o[12]=r=>e.goToStep(5))},null,8,["disable"]),i(k,{flat:"",color:"primary",label:"Back",class:"q-ml-sm",onClick:o[13]||(o[13]=r=>e.goToStep(3))})]),_:1})]),_:1},8,["icon","done"]),i(Q,{name:5,title:"Aperçu",icon:e.mdiBarcode},{default:p(()=>[E("div",null,[e.showBarcodePreview&&e.form.barcode.code.length?(h(),D(e.BarCodeRender,{key:0,"barcode-value":e.form.barcode,"barcode-width":1.3},null,8,["barcode-value"])):V("",!0)]),e.responseError?(h(),$("p",Co,L(e.responseError),1)):V("",!0),i(T,null,{default:p(()=>[i(k,{color:"primary",label:"Enregistrer",type:"submit",loading:e.isSaving},null,8,["loading"]),i(k,{flat:"",color:"primary",label:"Back",class:"q-ml-sm",onClick:o[14]||(o[14]=r=>e.goToStep(4))})]),_:1})]),_:1},8,["icon"])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}const ho=I(go,[["render",So],["__file","CardDialog.vue"]]),yo=O({__name:"WalletPage",setup(t,{expose:o}){o();const u=ie(),{cards:e,cardsForShopping:n}=Y(u),m=Ge(),{isDialogDeleteVisible:r}=Y(m),d=xe(),s=Be(),b=S([]),g=S(),f=S(!1),_=S(null),x=w(()=>!!s.query.showShoppingCard);Z(()=>{x.value?b.value=n.value:b.value=e.value});function B(v){_.value=v,m.showDeleteDialog()}async function c(){_.value&&(f.value=!0,await u.removeCard(_.value.id),m.hideDeleteDialog(),b.value=e.value,f.value=!1)}function l(v,y){d.push({name:"wallet-id",params:{id:v},state:{name:y}})}const a={cardsStore:u,cards:e,cardsForShopping:n,globalStore:m,isDialogDeleteVisible:r,router:d,route:s,cardsToDisplay:b,colorPicker:g,isDeleting:f,selectedCard:_,showShoppingCard:x,handleCardToDelete:B,deleteElement:c,goToWallet:l,CardDialog:ho,get draggable(){return Ye},get dragOptions(){return ke},get mdiDelete(){return We},get mdiReorderHorizontal(){return Ke},BarcodeRender:se,DeleteDialog:Je};return Object.defineProperty(a,"__isScriptSetup",{enumerable:!1,value:!0}),a}}),wo={class:"text-h5 font-bold italic"};function Do(t,o,u,e,n,m){return h(),D(Ee,{key:"wallet",padding:""},{default:p(()=>[i(e.draggable,Pe({modelValue:e.cardsToDisplay,"onUpdate:modelValue":o[1]||(o[1]=r=>e.cardsToDisplay=r),tag:"div","item-key":"id"},e.dragOptions,{handle:".handle_icon"}),{item:p(({element:r})=>[(h(),D(ne,{key:r.id,class:"mb-4 border-1 border-gray-500 border-opacity-25",style:Ve({backgroundColor:r.color}),onClick:d=>e.goToWallet(r.id,r.shop.label)},{default:p(()=>[i(G,{class:"mb-1 flex flex-row"},{default:p(()=>[E("div",wo,L(r.shop.label),1),i(te),e.showShoppingCard?V("",!0):(h(),D(j,{key:0,name:"palette",size:"sm",color:"grey-8",class:"cursor-pointer",onClick:o[0]||(o[0]=J(()=>{},["stop"]))},{default:p(()=>[i(me,{ref:"colorPicker","transition-show":"scale","transition-hide":"scale"},{default:p(()=>[i(ue,{modelValue:r.color,"onUpdate:modelValue":d=>r.color=d,"no-header":"","no-footer":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1536)]),_:2},1024)),e.showShoppingCard?V("",!0):(h(),D(j,{key:1,class:"icon-delete mx-4",size:"sm",color:"grey-8",name:e.mdiDelete,onClick:J(d=>e.handleCardToDelete(r),["stop"])},null,8,["name","onClick"])),i(j,{class:"handle_icon",color:"grey-8",size:"sm",name:e.mdiReorderHorizontal},null,8,["name"])]),_:2},1024),i(qe),i(G,{class:"flex flex-center"},{default:p(()=>[i(e.BarcodeRender,{"barcode-value":r.barcode},null,8,["barcode-value"])]),_:2},1024)]),_:2},1032,["style","onClick"]))]),_:1},16,["modelValue"]),i(e.CardDialog),e.selectedCard?(h(),D(e.DeleteDialog,{key:0,"show-dialog-delete":e.isDialogDeleteVisible,"onUpdate:showDialogDelete":o[2]||(o[2]=r=>e.isDialogDeleteVisible=r),"is-deleting":e.isDeleting,"onUpdate:isDeleting":o[3]||(o[3]=r=>e.isDeleting=r),"element-name":e.selectedCard.shop.label,"element-type":"la carte",onDeleteElement:e.deleteElement},null,8,["show-dialog-delete","is-deleting","element-name"])):V("",!0)]),_:1})}const Jo=I(yo,[["render",Do],["__file","WalletPage.vue"]]);export{Jo as default};
